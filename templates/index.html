<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <title>Run Pace Calculator</title>
</head>
<body>
    <div class="container">
        <h1><a href="/" style="text-decoration: none; color: #d72525;">Run Pace Calc</a></h1>
        <div class="input-group">
            <label for="time">Time</label>
            <input id="time" type="text" maxlength="8" placeholder="Enter time ( 2 ~ 6 numbers )">
        </div>
        <div class="input-group">
            <div class="distance-label-wrapper">
                <label for="distance">Distance</label>
                <div class="shortcut-buttons">
                    <button class="shortcut" data-value="0.4">400m</button>
                    <button class="shortcut" data-value="0.8">800m</button>
                    <button class="shortcut" data-value="2">2k</button>
                    <button class="shortcut" data-value="3">3k</button>
                    <button class="shortcut" data-value="5">5k</button>
                    <button class="shortcut" data-value="10">10k</button>
                    <button class="shortcut" data-value="21.0975">åŠé©¬</button>
                    <button class="shortcut" data-value="42.195">å…¨é©¬</button>
                </div>
            </div>
            <div class="distance-wrapper">
                <input id="distance" type="number" step="0.01" placeholder="Enter distance">
                <span class="unit">km &nbsp;&nbsp;&nbsp;&nbsp;</span>
            </div>
        </div>
        <div class="output-group">
            <label for="pace">Pace</label>
            <div id="pace" class="output-box">>_<</div>
        </div>

        <!-- <div style="text-align: right; margin-top: -10px; margin-bottom: -15px;">
            <a href="https://github.com/Daleveral/running-pace" target="_blank" style="text-decoration: none; color: #d72525;">
            about
            </a>
        </div> -->

        <button id="about-btn" class="about-btn">About</button>

    </div>


    <div id="about-window" class="about-window">
        <div class="about-content">
          <div class ="about-info">
            <p>æ—¶é•¿æ¡†å¯ä»¥è¾“å…¥ 2 ~ 6 ä¸ªæ•°å­—, è¾“å…¥åå›è½¦æˆ–ç‚¹å‡»æ¡†å¤–å³å¯, æ•°å­—è¯†åˆ«è§„åˆ™ä¸º :</p>
            <ul>
              <li>ä¸¤ä¸ªæ•°å¦‚ 12 â†’ 12 åˆ†é’Ÿ</li>
              <li>ä¸‰ä¸ªæ•°å¦‚ 123 â†’ 1 å°æ—¶ 23 åˆ†</li>
              <li>å››ä¸ªæ•°å¦‚ 1234 â†’ 12 åˆ† 34 ç§’</li>
              <li>äº”ä¸ªæ•°å¦‚ 12345 â†’ 1 å°æ—¶ 23 åˆ† 45 ç§’</li>
              <li>å…­ä¸ªæ•°å¦‚ 123456 â†’ 12 å°æ—¶ 34 åˆ† 56 ç§’ ï¼ˆ è¶Šé‡è·‘å¤§ä½¬ ğŸ‘ğŸ» ï¼‰</li>
            </ul>
            <p>è·¯ç¨‹æ¡†å¯ä»¥è‡ªç”±è¾“å…¥å…¬é‡Œæ•°, ä¹Ÿæœ‰å‡ ä¸ªå¿«æ·æŒ‰é’®, 400m, 10km, åŠé©¬, å…¨é©¬ç­‰. è®¡ç®—æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå‰é¢ä¸¤ä¸ªæ•°å€¼è¾“å…¥äº†ï¼Œé…é€Ÿä¹ŸåŒæ­¥è®¡ç®—. ç‚¹å‡»çº¢è‰²æ ‡é¢˜ Run Pace Calc å³å¯æ¸…ç©ºå†…å®¹.</p>
            <p >ä½œè€… : <a href="https://github.com/Daleveral/" target="_blank" style="color:#191b9a; text-decoration: none;">Dale</a>  
                /  æºä»£ç  : <a href="https://github.com/Daleveral/running-pace" target="_blank" style="color:#d72525; text-decoration: none;">GitHub Repo</a></p>
          </div>
          <button id="confirm-btn" class="confirm-btn">çŸ¥é“äº†</button>
        </div>
      </div>


    <script>
        function calculatePace(timeInSeconds, distance) { // è®¡ç®—é…é€Ÿ
            if (distance > 0) {
                const paceInSeconds = timeInSeconds / distance;
                const minutes = Math.floor(paceInSeconds / 60);
                const seconds = Math.round(paceInSeconds % 60);
                return `${minutes}' ${seconds.toString().padStart(2, '0')}"`;
            }
            return '-';
        }

        function parseTime(raw) { // è§£ææ—¶é—´
            if (!/\d/.test(raw)) {
                if (raw === "åŸºæ™®å›¾å§†") { return { hours: 2, minutes: 0, seconds: 35 };}
                if (raw === "kiptum" || raw === "Kiptum" ) { return { hours: 2, minutes: 0, seconds: 35 };}
                if (raw === "åŸºæ™®ä¹”æ ¼") { return { hours: 2, minutes: 1, seconds: 9 };}
                if (raw === "kipchoge" || raw === "Kipchoge" ) { return { hours: 2, minutes: 1, seconds: 9 };}
                if (raw === "ä¸–ç•Œçºªå½•") { return { hours: 2, minutes: 0, seconds: 35 };}
                if (raw === "åŠé©¬") { return { hours: 0, minutes: 57, seconds: 30 };}
                if (raw === "ç§‘æ°å°”æŸ¥") { return { hours: 0, minutes: 57, seconds: 30 };}
                if (raw === "å¤§è¿«æ°") { return { hours: 2, minutes: 5, seconds: 29 };}
                if (raw === "è´å…‹å‹’") { return { hours: 2, minutes: 1, seconds: 41 };}
                if (raw === "ä½•æ°") { return { hours: 2, minutes: 6, seconds: 57 };}
                if (raw === "æ‰è¥¿æ¬¡ä»") { return { hours: 1, minutes: 1, seconds: 57 };}
                if (raw === "åˆ‡æ™®æ ¼è’‚å¥‡") { return { hours: 2, minutes: 9, seconds: 56 };}
                if (raw === "ä¸€çº§") { return { hours: 2, minutes:31, seconds: 10 };}
                if (raw === "äºŒçº§") { return { hours: 2, minutes:51, seconds: 30 };}
                if (raw === "å¥å°†") { return { hours: 2, minutes:19, seconds: 20 };}
                if (raw === "åŠé©¬ä¸€çº§") { return { hours: 1, minutes:11, seconds: 30 };}
                if (raw === "åŠé©¬äºŒçº§") { return { hours: 1, minutes:17, seconds: 30 };}
                if (raw === "åŠé©¬å¥å°†") { return { hours: 1, minutes:6, seconds: 0 };}
                if (raw === "Dale" || raw === "dale" ) { return { hours: 1, minutes: 58, seconds: 35 };}
            }

            raw = raw.replace(/[^0-9]/g, '');
            let hours = 0, minutes = 0, seconds = 0;

            if (raw.length === 2) {
                minutes = parseInt(raw, 10);
            } else if (raw.length === 3) {
                hours = parseInt(raw[0], 10);
                minutes = parseInt(raw.slice(1), 10);
            } else if (raw.length === 4) {
                minutes = parseInt(raw.slice(0, 2), 10);
                seconds = parseInt(raw.slice(2), 10);
            } else if (raw.length === 5) {
                hours = parseInt(raw[0], 10);
                minutes = parseInt(raw.slice(1, 3), 10);
                seconds = parseInt(raw.slice(3), 10);
            } else if (raw.length === 6) {
                hours = parseInt(raw.slice(0, 2), 10);
                minutes = parseInt(raw.slice(2, 4), 10);
                seconds = parseInt(raw.slice(4), 10);
            }
            return { hours, minutes, seconds };
        }

        function formatTime(hours, minutes, seconds) { // æ ¼å¼åŒ–æ—¶é—´
            return `${hours.toString().padStart(2, '0')} : ${minutes.toString().padStart(2, '0')} : ${seconds.toString().padStart(2, '0')}`;
        }

        const timeInput = document.getElementById('time');
        timeInput.addEventListener('focus', () => {
            const raw = timeInput.value;
            if (raw && raw.includes(':')) {
                // å…è®¸åœ¨å·²æœ‰æ—¶åˆ†ç§’æ ¼å¼ä¸‹ä¿®æ”¹
                timeInput.value = raw.replace(/[^0-9]/g, '');
            }
        });

        timeInput.addEventListener('blur', () => {
            const raw = timeInput.value;
            if (raw.length >= 1) {
                const { hours, minutes, seconds } = parseTime(raw);
                timeInput.value = formatTime(hours, minutes, seconds);
                updatePace();
            }
        });

        timeInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter' && timeInput.value.length >= 3) {
                const raw = timeInput.value;
                const { hours, minutes, seconds } = parseTime(raw);
                timeInput.value = formatTime(hours, minutes, seconds);
                updatePace();
                timeInput.blur();
            }
        });


        const distanceInput = document.getElementById('distance');
        document.querySelectorAll('.shortcut').forEach(button => {
            button.addEventListener('click', () => {
                const value = button.getAttribute('data-value');
                distanceInput.value = value;
                updatePace();
            });
        });

        distanceInput.addEventListener('input', updatePace);

        function updatePace() {
            const timeRaw = document.getElementById('time').value;
            const { hours, minutes, seconds } = parseTime(timeRaw);
            const timeInSeconds = hours * 3600 + minutes * 60 + seconds;
            const distance = parseFloat(document.getElementById('distance').value);
            document.getElementById('pace').textContent = calculatePace(timeInSeconds, distance);
        }

        document.getElementById('about-btn').addEventListener('click', function() {
            document.getElementById('about-window').style.display = 'flex';
        });

        document.getElementById('confirm-btn').addEventListener('click', function() {
            document.getElementById('about-window').style.display = 'none';
        });

        document.getElementById('about-window').addEventListener('click', function(event) {
            if (event.target === document.getElementById('about-window')) {
            document.getElementById('about-window').style.display = 'none';
            }
        });


    </script>
</body>
</html>
